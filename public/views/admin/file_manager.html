<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–§–∞–π–ª–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä</title>
    <link rel="stylesheet" type="text/css" href="../../assets/css/admin/file_manager.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
<h1>–§–∞–π–ª–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä</h1>

<div class="nav-buttons">
    <a href="/admin" class="nav-button" title="–í –∫–æ—Ä–Ω–µ–≤—É—é –ø–∞–ø–∫—É">
        <i class="fas fa-home"></i>
    </a>

    {{if $backPath}}
    <a href="?path={{ backPath }}" class="nav-button" title="–ù–∞–∑–∞–¥">
        <i class="fas fa-arrow-left"></i>
    </a>
    {{endif}}

    <span class="current-path">{{ currentPath }}</span>
</div>

<form method="post" action="/admin/files/upload?path={{ currentPathEncoded }}" enctype="multipart/form-data">
    <input type="file" name="file" required>
    <button type="submit">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</button>
</form>

<form method="post" action="/admin/files/mkdir?path={{ currentPathEncoded }}" style="margin-top: 15px;">
    <label>
        <input type="text" name="directory" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏" required>
    </label>
    <button type="submit">–°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É</button>
</form>

<table class="file-table">
    <tbody>
    {{foreach $files as $file}}
    <tr class="{{ file['name'] }}">
        <td class="file-name">
            {{if $file['isDir']}}üìÅ{{else}}üìÑ{{endif}}

            {{if $file['isDir']}}
            <a href="?path={{ file['url'] }}">
                {{ file['name'] }}
            </a>
            {{else}}
            <a href="/admin/files/edit?file={{ file['url'] }}">
                {{ file['name'] }}
            </a>
            {{endif}}
        </td>

        <td>
            {{if !$file['isDir']}}
            <a href="/admin/files/download?file={{ file['url'] }}">–°–∫–∞—á–∞—Ç—å</a>
            {{endif}}
        </td>

        <td>
            <form method="post" action="/admin/files/delete" style="display:inline;">
                <input type="hidden" name="file" value="{{ file['fullPath'] }}">
                {{if $file['isDir']}}
                <button type="submit" onclick="return confirm('–£–¥–∞–ª–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é?')">–£–¥–∞–ª–∏—Ç—å</button>
                {{else}}
                <button type="submit" onclick="return confirm('–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª?')">–£–¥–∞–ª–∏—Ç—å</button>
                {{endif}}
            </form>
        </td>
    </tr>
    {{endforeach}}
    </tbody>
</table>


</body>
</html>
